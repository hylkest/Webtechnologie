{% include "includes/header.html" %}

<div class="container d-flex justify-content-center mt-5">

  <div class="card shadow p-4" style="width: 420px; border-radius: 14px;">

    <h5 class="text-center mb-4">Create new post</h5>

    <div class="mb-3 text-center">

      <img id="imagePreview"
           class="img-fluid d-none"
           style="max-height: 300px; object-fit: cover; border-radius: 10px;">

      <video id="videoPreview"
             class="w-100 d-none"
             style="max-height: 300px; border-radius: 10px;"
             controls></video>
    </div>

    <div class="post-hash-preview mb-3">
      <span class="post-hash-label">Hash</span>
      <code>0000000000000000000a9f2c7d1b3e5f</code>
    </div>

    <form action="{{ url_for('create_post') }}"
          method="POST"
          enctype="multipart/form-data">

      <div class="mb-3">
        <input type="file"
               name="media"
               class="form-control"
               accept="image/*,video/*"
               required
               onchange="previewMedia(event)">

      </div>

      <div class="mb-3">
        <input type="text"
               name="title"
               class="form-control"
               placeholder="Add a title (optional)">

      </div>

      <div class="mb-3">
        <textarea name="caption"
                  class="form-control"
                  rows="3"
                  placeholder="Write a caption..."></textarea>

      </div>

      <button type="submit" class="btn btn-primary w-100">
        Share
      </button>

    </form>

  </div>
</div>

<script>
/* Laat direct een preview zien van de gekozen image of video */
function previewMedia(event) {
  const file = event.target.files[0];
  if (!file) return;

  const img = document.getElementById("imagePreview");
  const video = document.getElementById("videoPreview");

  // Verberg beide previews eerst
  img.classList.add("d-none");
  video.classList.add("d-none");

  const url = URL.createObjectURL(file);

  // Toon image preview
  if (file.type.startsWith("image")) {
    img.src = url;
    img.classList.remove("d-none");
  }
  // Toon video preview
  else if (file.type.startsWith("video")) {
    video.src = url;
    video.classList.remove("d-none");
  }
}
</script>

{% include "includes/footer.html" %}
