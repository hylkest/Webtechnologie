{% include "includes/header.html" %}

<div class="container mt-4" style="max-width: 900px;">

  {% if profile_user['profile_photo'] %}
    {% set avatar_url = url_for('static', filename=profile_user['profile_photo']) %}
  {% else %}
    {% set avatar_url = url_for('static', filename='default_profile.png') %}
  {% endif %}

  <div class="d-flex align-items-center">

    <img src="{{ avatar_url }}"
         class="rounded-circle"
         alt="Profielfoto"
         style="width:130px;height:130px;object-fit:cover;">

    <div class="ms-4 flex-grow-1">
      <h3>{{ profile_user['username'] }}</h3>

      <div class="d-flex mb-3">
        <div class="me-4"><strong>{{ posts|length }}</strong> posts</div>
        <div class="me-4"><strong>0</strong> followers</div>
        <div class="me-4"><strong>0</strong> following</div>
      </div>

      <div class="d-flex gap-2">
        <a href="{{ url_for('edit_profile_page') }}" class="btn btn-light border">Edit Profile</a>
        <a href="{{ url_for('new_post') }}" class="btn btn-primary">
          Upload post
        </a>
      </div>
    </div>
  </div>

  <div class="mt-3">
    <strong>{{ profile_user['username'] }}</strong><br>
    {{ profile_user['bio'] or "Nog geen bio toegevoegd." }}
  </div>

  <hr>

  <div class="row g-3 profile-post-grid">
    {% if posts %}
      {% for post in posts %}
        <div class="col-12 col-sm-6 col-md-4">
          <div class="profile-post-card">
            <div class="profile-post-media">
              {% if post["media_type"] == "image" %}
                <img src="{{ url_for('static', filename=post['media_path']) }}"
                     alt="{{ post['title'] or 'Post afbeelding' }}">
              {% else %}
                <video muted loop>
                  <source src="{{ url_for('static', filename=post['media_path']) }}">
                </video>
              {% endif %}
            </div>
            <div class="profile-post-actions">
              <a href="{{ url_for('edit_post', post_id=post['id']) }}" class="btn btn-light btn-sm">
                Edit
              </a>
              <form method="POST"
                    action="{{ url_for('delete_post', post_id=post['id']) }}"
                    onsubmit="return confirm('Weet je zeker dat je deze post wilt verwijderen?');">
                <button type="submit" class="btn btn-light btn-sm">Delete</button>
              </form>
            </div>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <div class="col-12 col-md-6 mx-auto">
        <div class="profile-post-card d-flex align-items-center justify-content-center flex-column text-center">
          <p class="text-muted mb-3">Nog geen posts geplaatst.</p>
          <a href="{{ url_for('new_post') }}" class="btn btn-primary">Upload post</a>
        </div>
      </div>
    {% endif %}
  </div>

</div>

{% include "includes/footer.html" %}
